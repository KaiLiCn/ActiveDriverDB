{% extends "base.html" %}

{% block title %} {{ protein.name }} - protein view {% endblock %}

{% block head %}
  <script src="https://wzrd.in/bundle/muts-needle-plot@0.9.1"></script>
  <script src="http://workmen.biojs.net/github/bbglab/muts-needle-plot/master/src/js/dependencies/d3.js"></script>
  <script src="http://workmen.biojs.net/github/bbglab/muts-needle-plot/master/src/js/dependencies/underscore.js"></script>
  <script src="http://workmen.biojs.net/github/bbglab/muts-needle-plot/master/src/js/d3-svg-legend.js"></script>
  <script src="/static/thirdparty/jquery-1.12.0.min.js"></script>
{% endblock %}



{% block content %}

<h3>{{ protein.name }}</h3>

<ol class="breadcrumb">
  <li><a href="/">Home</a></li>
  <li><a href="/protein">Proteins</a></li>
  <li class="active">{{ protein.name }}</li>
</ol>

<div id="plot_area"></div>

RefSeq: <a href='http://www.ncbi.nlm.nih.gov/nuccore/{{ protein.refseq }}'>{{ protein.refseq }}</a>


<div class="panel panel-default">
  <div class="panel-body">
    {% with tracks=tracks, sequence=protein.sequence %}
      {% include 'tracks.html' %}
    {% endwith %}
    </div>
 </div>
</div>

{% endblock %}


{% block footer_js %}
    {% assets "js_needleplot" %}
	<script type="text/javascript" src="{{ ASSET_URL }}"></script>
    {% endassets %}
    {% assets "js_tracks" %}
	<script type="text/javascript" src="{{ ASSET_URL }}"></script>
    {% endassets %}
    <script type="text/javascript">
        var params = {
            element: document.getElementById('plot_area'),
            mutations: '{{ url_for('ProteinView:mutations', name=protein.name) }}',
            sites: '{{ url_for('ProteinView:sites', name=protein.name) }}',
            sequenceLength: {{ protein.sequence | length }},
            name: '{{ protein.name }}',
            refseq: '{{ protein.refseq }}'
        }
        NeedlePlot.init(params)
    </script>
{% endblock %}
